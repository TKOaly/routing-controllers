{"version":3,"sources":["../../src/metadata/ControllerMetadata.ts"],"names":[],"mappings":";;AAGA,0CAA8C;AAI9C;;GAEG;AACH;IA8CI,4EAA4E;IAC5E,cAAc;IACd,4EAA4E;IAE5E,4BAAY,IAA4B;QACpC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;QAC1B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QACxB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;IAC1B,CAAC;IASD,sBAAI,wCAAQ;QAPZ,4EAA4E;QAC5E,YAAY;QACZ,4EAA4E;QAE5E;;WAEG;aACH;YACI,MAAM,CAAC,4BAAgB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QACzC,CAAC;;;OAAA;IAED,4EAA4E;IAC5E,iBAAiB;IACjB,4EAA4E;IAE5E;;;OAGG;IACH,kCAAK,GAAL,UAAM,gBAA2C;QAC7C,IAAM,iBAAiB,GAAG,gBAAgB,CAAC,IAAI,CAAC,UAAA,OAAO,IAAI,OAAA,OAAO,CAAC,IAAI,KAAK,YAAY,IAAI,CAAC,OAAO,CAAC,MAAM,EAAhD,CAAgD,CAAC,CAAC;QAC7G,IAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC,iBAAiB,CAAC;QAC5C,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC,MAAM,CAAC,CAAC,iBAAiB,IAAI,iBAAiB,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC;IAC3F,CAAC;IAEL,yBAAC;AAAD,CAjFA,AAiFC,IAAA;AAjFY,gDAAkB","file":"ControllerMetadata.js","sourcesContent":["import {ActionMetadata} from \"./ActionMetadata\";\r\nimport {ControllerMetadataArgs} from \"./args/ControllerMetadataArgs\";\r\nimport {UseMetadata} from \"./UseMetadata\";\r\nimport {getFromContainer} from \"../container\";\r\nimport {ResponseHandlerMetadata} from \"./ResponseHandleMetadata\";\r\nimport {InterceptorMetadata} from \"./InterceptorMetadata\";\r\n\r\n/**\r\n * Controller metadata.\r\n */\r\nexport class ControllerMetadata {\r\n\r\n    // -------------------------------------------------------------------------\r\n    // Properties\r\n    // -------------------------------------------------------------------------\r\n\r\n    /**\r\n     * Controller actions.\r\n     */\r\n    actions: ActionMetadata[];\r\n\r\n    /**\r\n     * Indicates object which is used by this controller.\r\n     */\r\n    target: Function;\r\n\r\n    /**\r\n     * Base route for all actions registered in this controller.\r\n     */\r\n    route: string;\r\n\r\n    /**\r\n     * Controller type. Can be default or json-typed. Json-typed controllers operate with json requests and responses.\r\n     */\r\n    type: \"default\"|\"json\";\r\n\r\n    /**\r\n     * Middleware \"use\"-s applied to a whole controller.\r\n     */\r\n    uses: UseMetadata[];\r\n\r\n    /**\r\n     * Middleware \"use\"-s applied to a whole controller.\r\n     */\r\n    interceptors: InterceptorMetadata[];\r\n\r\n    /**\r\n     * Indicates if this action uses Authorized decorator.\r\n     */\r\n    isAuthorizedUsed: boolean;\r\n\r\n    /**\r\n     * Roles set by @Authorized decorator.\r\n     */\r\n    authorizedRoles: any[];\r\n\r\n    // -------------------------------------------------------------------------\r\n    // Constructor\r\n    // -------------------------------------------------------------------------\r\n    \r\n    constructor(args: ControllerMetadataArgs) {\r\n        this.target = args.target;\r\n        this.route = args.route;\r\n        this.type = args.type;\r\n    }\r\n\r\n    // -------------------------------------------------------------------------\r\n    // Accessors\r\n    // -------------------------------------------------------------------------\r\n\r\n    /**\r\n     * Gets instance of the controller.\r\n     */\r\n    get instance(): any {\r\n        return getFromContainer(this.target);\r\n    }\r\n\r\n    // -------------------------------------------------------------------------\r\n    // Public Methods\r\n    // -------------------------------------------------------------------------\r\n\r\n    /**\r\n     * Builds everything controller metadata needs.\r\n     * Controller metadata should be used only after its build.\r\n     */\r\n    build(responseHandlers: ResponseHandlerMetadata[]) {\r\n        const authorizedHandler = responseHandlers.find(handler => handler.type === \"authorized\" && !handler.method);\r\n        this.isAuthorizedUsed = !!authorizedHandler;\r\n        this.authorizedRoles = [].concat((authorizedHandler && authorizedHandler.value) || []);\r\n    }\r\n\r\n}"],"sourceRoot":".."}